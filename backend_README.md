# Naseri ERP Backend Documentation

## Overview
این پروژه یک سیستم ERP کامل با استفاده از Django و Django REST Framework است که ماژول‌های حسابداری، انبار، خرید، فروش، محصولات و کاربران را پوشش می‌دهد.

## Main Features
- مدیریت کاربران و احراز هویت (با شماره موبایل)
- مدیریت محصولات، دسته‌بندی و واحدها
- مدیریت انبار و تراکنش‌های موجودی
- مدیریت خرید و تأمین‌کنندگان
- مدیریت فروش و مشتریان
- سیستم حسابداری کامل (سند، حساب، سال مالی، هزینه و ...)
- گزارش‌گیری پیشرفته (خرید، فروش، انبار، حسابداری)
- حذف منطقی (soft delete) برای کاربران و محصولات
- فیلدهای تاریخچه (audit log) برای ردیابی تغییرات

## End-to-End Scenario (Sample Business Flow)
1. **ثبت و ورود ادمین**
2. **تعریف تأمین‌کننده جدید**
3. **تعریف دسته‌بندی و واحد جدید**
4. **تعریف محصول جدید**
5. **تعریف انبار جدید**
6. **ثبت خرید جدید و افزودن آیتم خرید**
7. **دریافت کالا و ثبت در انبار**
8. **صدور فاکتور خرید و پرداخت**
9. **تعریف مشتری جدید**
10. **ثبت فروش جدید و افزودن آیتم فروش**
11. **ثبت دریافت وجه از مشتری و صدور فاکتور فروش**
12. **بررسی گزارش‌ها (انبار، خرید، فروش، حسابداری)**
13. **حذف منطقی یک محصول و بررسی عدم نمایش آن**
14. **ویرایش اطلاعات و بررسی audit log**

این سناریو به طور کامل در فایل `users/tests_e2e.py` پیاده‌سازی و تست شده است.

## How to Run Backend
1. نصب پیش‌نیازها:
   ```
   pip install -r requirements.txt
   ```
2. اعمال مهاجرت‌ها:
   ```
   python manage.py migrate
   ```
3. اجرای سرور توسعه:
   ```
   python manage.py runserver
   ```
4. اجرای تست‌ها:
   ```
   python manage.py test
   ```
   یا برای تست end-to-end:
   ```
   python manage.py test users.tests_e2e
   ```

## Soft Delete
- مدل‌های User و Product دارای فیلد is_deleted هستند.
- حذف منطقی باعث می‌شود رکورد در لیست‌ها نمایش داده نشود اما اطلاعات آن باقی بماند.

## Audit Log
- فیلدهای created_at، updated_at، created_by، updated_by برای ردیابی تغییرات در مدل‌های کلیدی استفاده می‌شود.

## نکات مهم
- فقط ادمین می‌تواند کاربر جدید ثبت کند.
- تست‌های واحد و API برای همه ماژول‌ها نوشته شده است.
- تست end-to-end چرخه کامل ERP را پوشش می‌دهد.

---
برای توسعه frontend و اتصال به APIها، می‌توانید از سناریوی بالا و مستندات endpointها استفاده کنید.